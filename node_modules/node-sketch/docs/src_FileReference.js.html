<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>src/FileReference.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Attributes.html">Attributes</a><ul class='methods'><li data-type='method'><a href="Attributes.html#clone">clone</a></li><li data-type='method'><a href="Attributes.html#detach">detach</a></li><li data-type='method'><a href="Attributes.html#get">get</a></li><li data-type='method'><a href="Attributes.html#getAll">getAll</a></li><li data-type='method'><a href="Attributes.html#getParent">getParent</a></li><li data-type='method'><a href="Attributes.html#getSketch">getSketch</a></li><li data-type='method'><a href="Attributes.html#push">push</a></li><li data-type='method'><a href="Attributes.html#replaceWith">replaceWith</a></li><li data-type='method'><a href="Attributes.html#set">set</a></li><li data-type='method'><a href="Attributes.html#toJson">toJson</a></li></ul></li><li><a href="FileReference.html">FileReference</a><ul class='methods'><li data-type='method'><a href="FileReference.html#clone">clone</a></li><li data-type='method'><a href="FileReference.html#detach">detach</a></li><li data-type='method'><a href="FileReference.html#export">export</a></li><li data-type='method'><a href="FileReference.html#get">get</a></li><li data-type='method'><a href="FileReference.html#getAll">getAll</a></li><li data-type='method'><a href="FileReference.html#getParent">getParent</a></li><li data-type='method'><a href="FileReference.html#getSketch">getSketch</a></li><li data-type='method'><a href="FileReference.html#push">push</a></li><li data-type='method'><a href="FileReference.html#replaceWith">replaceWith</a></li><li data-type='method'><a href="FileReference.html#set">set</a></li><li data-type='method'><a href="FileReference.html#toJson">toJson</a></li></ul></li><li><a href="Node.html">Node</a><ul class='methods'><li data-type='method'><a href="Node.html#clone">clone</a></li><li data-type='method'><a href="Node.html#detach">detach</a></li><li data-type='method'><a href="Node.html#get">get</a></li><li data-type='method'><a href="Node.html#getAll">getAll</a></li><li data-type='method'><a href="Node.html#getParent">getParent</a></li><li data-type='method'><a href="Node.html#getSketch">getSketch</a></li><li data-type='method'><a href="Node.html#push">push</a></li><li data-type='method'><a href="Node.html#replaceWith">replaceWith</a></li><li data-type='method'><a href="Node.html#set">set</a></li><li data-type='method'><a href="Node.html#toJson">toJson</a></li></ul></li><li><a href="Sketch.html">Sketch</a><ul class='methods'><li data-type='method'><a href="Sketch.html#save">save</a></li><li data-type='method'><a href="Sketch.html#saveDir">saveDir</a></li></ul></li><li><a href="Style.html">Style</a><ul class='methods'><li data-type='method'><a href="Style.html#applySharedStyle">applySharedStyle</a></li><li data-type='method'><a href="Style.html#clone">clone</a></li><li data-type='method'><a href="Style.html#detach">detach</a></li><li data-type='method'><a href="Style.html#get">get</a></li><li data-type='method'><a href="Style.html#getAll">getAll</a></li><li data-type='method'><a href="Style.html#getParent">getParent</a></li><li data-type='method'><a href="Style.html#getSketch">getSketch</a></li><li data-type='method'><a href="Style.html#push">push</a></li><li data-type='method'><a href="Style.html#replaceWith">replaceWith</a></li><li data-type='method'><a href="Style.html#set">set</a></li><li data-type='method'><a href="Style.html#toJson">toJson</a></li></ul></li><li><a href="SymbolInstance.html">SymbolInstance</a><ul class='methods'><li data-type='method'><a href="SymbolInstance.html#clone">clone</a></li><li data-type='method'><a href="SymbolInstance.html#detach">detach</a></li><li data-type='method'><a href="SymbolInstance.html#get">get</a></li><li data-type='method'><a href="SymbolInstance.html#getAll">getAll</a></li><li data-type='method'><a href="SymbolInstance.html#getParent">getParent</a></li><li data-type='method'><a href="SymbolInstance.html#getSketch">getSketch</a></li><li data-type='method'><a href="SymbolInstance.html#push">push</a></li><li data-type='method'><a href="SymbolInstance.html#replaceWith">replaceWith</a></li><li data-type='method'><a href="SymbolInstance.html#set">set</a></li><li data-type='method'><a href="SymbolInstance.html#toJson">toJson</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#read">read</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">src/FileReference.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Node = require('./Node');
const path = require('path');
const fs = require('fs');

/**
 * Represents a file, for example an image
 *
 * @extends {Node}
 *
 * @property {string|undefined} file - The path to the saved file in the sketch
 */
class FileReference extends Node {
    get file() {
        if (this._ref_class === 'MSImageData') {
            return this._ref;
        }
    }

    /**
     * Exports the file to other location
     *
     * @param  {string} dir - The directory path of the exported file.
     *
     * @example
     * //Export all images to a directory
     * sketch.pages.forEach(page => {
     *     page.getAll('MSJSONFileReference').forEach(ref => {
     *         ref.export('/path/to/export');
     *     })
     * })
     */
    export(dir) {
        return new Promise((fulfill, reject) => {
            const sketch = this.getParent('sketch');
            const file = sketch.repo
                .filter(f => {
                    return f.startsWith(this.file);
                })
                .pop();

            if (file) {
                const dest = path.join(dir, path.basename(file.name));

                file.nodeStream()
                    .pipe(fs.createWriteStream(dest))
                    .on('finish', () => {
                        fulfill(dest);
                    })
                    .on('error', err => {
                        reject(err);
                    });
            } else {
                reject('No file found');
            }
        });
    }
}

module.exports = FileReference;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Dec 24 2018 14:13:01 GMT+0100 (hora est√°ndar de Europa central) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
